@model WebApplication1.Models.ViewModel.PurchaseRequestViewModel
@{
    ViewData["Title"] = "Detil " + ViewBag.PRNumber;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--Menampilkan Header PR-->
<section class="content" id="Header-Fixed">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>@ViewData["Title"]</h2>
            </div>
            <div class="card-body card-padding">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">

                                <div class="col-md-6">

                                    <!--Requester-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-account zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Requested By <span class="text-danger">*</span></label>
                                            <input asp-for="PRHeaderDetail.RequesterId" type="text" class="form-control" readonly />
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Departement Code-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-city zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Department Code</label>
                                            <input asp-for="PRHeaderDetail.ShortcutDimension1Code" type="text" class="form-control" readonly />
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Exp Receipt Date-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-calendar zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Exp. Receipt Date<span class="text-danger">*</span></label>
                                            <input asp-for="PRHeaderDetail.DueDate" type="date" class="form-control" readonly />
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Motive Requisition-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-assignment-o zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <textarea asp-for="PRHeaderDetail.RequestNotes" class="form-control" readonly></textarea>
                                            <label class="fg-label">Motive of Requisition<span class="text-danger">*</span></label>
                                        </div>
                                    </div>
                                    <br /><br />

                                </div>

                                <div class="col-md-6">

                                    <!--Location Code-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-pin zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Location<span class="text-danger">*</span></label>
                                            <select asp-for="PRHeaderDetail.LocationCode" asp-items="@ViewBag.LocationCode" class="selectpicker" data-width="100%" data-live-search="true" disabled>
                                                <option></option>
                                            </select>
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Project Code-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-label zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Project Code</label>
                                            <select asp-for="PRHeaderDetail.ShortcutDimension2Code" asp-items="@ViewBag.ProjectCode" class="selectpicker" data-width="100%" data-live-search="true" disabled>
                                                <option></option>
                                            </select>
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Priority-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-collection-item"></i></span>
                                        <div class="fg-line">
                                            <label>Priority<span class="text-danger">*</span></label>
                                            <select asp-for="PRHeaderDetail.Priority" asp-items="@ViewBag.Priority" class="selectpicker" data-width="100%" data-live-search="true" disabled>
                                                <option></option>
                                            </select>
                                        </div>
                                    </div>
                                    <br /><br />

                                    <!--Status-->
                                    <div class="input-group fg-float">
                                        <span class="input-group-addon"><i class="zmdi zmdi-assignment-check zmdi-hc-fw"></i></span>
                                        <div class="fg-line">
                                            <label>Status</label>
                                            <select asp-for="PRHeaderDetail.Status" asp-items="@ViewBag.Status" class="selectpicker" data-width="100%" disabled>
                                                <option></option>
                                            </select>
                                        </div>
                                    </div>
                                    <br /><br />

                                </div>

                            </div>
                            <div class="col-md-2 col-md-offset-5">
                                <button type="button" class="btn btn-block palette-Blue bg waves-effect" id="btnViewEditHeader" style="display:block"><span class="zmdi zmdi-edit zmdi-hc-fw"></span> Edit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<!--Menampilkan Header yg bisa diedit-->
<section class="content" id="Header-Editable">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>@ViewData["Title"]</h2>
            </div>
            <div class="card-body card-padding">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <form id="form-edit-header" role="form">

                                    <div class="col-md-6">

                                        <!--PR Number-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-file zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>PR Number <span class="text-danger">*</span></label>
                                                <input asp-for="PRHeaderDetail.RequisitionNo" type="text" class="form-control" id="PRNumber" readonly />
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Requester-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-account zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Requested By <span class="text-danger">*</span></label>
                                                <input asp-for="PRHeaderDetail.RequesterId" type="text" class="form-control" id="Requester" readonly />
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Departement Code-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-city zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Department Code</label>
                                                <input asp-for="PRHeaderDetail.ShortcutDimension1Code" type="text" class="form-control" id="DepartmentCode" readonly />
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Exp Receipt Date-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-calendar zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Exp. Receipt Date<span class="text-danger">*</span></label>
                                                <input asp-for="PRHeaderDetail.DueDate" type="date" class="form-control" id="receiptDate" required />
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Motive Requisition-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment-o zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <textarea asp-for="PRHeaderDetail.RequestNotes" class="form-control" id="ReqMotive" required></textarea>
                                                <label class="fg-label">Motive of Requisition<span class="text-danger">*</span></label>
                                            </div>
                                        </div>
                                        <br /><br />

                                    </div>

                                    <div class="col-md-6">

                                        <!--Location Code-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-pin zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Location<span class="text-danger">*</span></label>
                                                <select asp-for="PRHeaderDetail.LocationCode" asp-items="@ViewBag.LocationCode" class="selectpicker" data-width="100%" data-live-search="true" id="locationCode" required>
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Project Code-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-label zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Project Code</label>
                                                <select asp-for="PRHeaderDetail.ShortcutDimension2Code" asp-items="@ViewBag.ProjectCode" class="selectpicker" data-width="100%" data-live-search="true" id="ProjectCode" required>
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Priority-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-collection-item"></i></span>
                                            <div class="fg-line">
                                                <label>Priority<span class="text-danger">*</span></label>
                                                <select asp-for="PRHeaderDetail.Priority" asp-items="@ViewBag.Priority" class="selectpicker" data-width="100%" data-live-search="true" id="Priority" required>
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <br /><br />

                                        <!--Status-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment-check zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Status</label>
                                                <select asp-for="PRHeaderDetail.Status" asp-items="@ViewBag.Status" class="selectpicker" data-width="100%" disabled>
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <br /><br />

                                    </div>
                                </form>

                            </div>

                        </div>
                    </div>
                    <div class="col-md-2 col-md-offset-4">
                        <button type="button" class="btn btn-block palette-Blue bg waves-effect" id="btnEditHeader" style="display:block" onclick="ValidateHeader()"><span class="zmdi zmdi-edit zmdi-hc-fw"></span> Edit</button>
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="btn btn-block palette-Orange bg waves-effect" id="btnCancelHeader"><span class="zmdi zmdi-rotate-left zmdi-hc-fw"></span> Back</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Menampilkan Tabel daftar item di PR Tersebut-->
<section class="content" id="ListLine">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>List of @ViewBag.PRNumber</h2>
            </div>
            <div class="card-body card-padding">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12">
                            <button type="button" class="btn palette-Blue bg waves-effect" id="AddLineItems"><i class="zmdi zmdi-plus zmdi-hc-fw"></i> Add Items</button>
                            <div class="table-responsive">
                                <table id="tabel-daftar-item" class="table table-vmiddle" style="table-layout: auto;">
                                    <thead>
                                        <tr>
                                            <th data-column-id="ID" data-header-css-class="ID" data-identifier="true" data-visible="false" data-sortable="false">ID</th>
                                            <th data-column-id="No" data-header-css-class="No">No</th>
                                            <th data-column-id="recNo" data-header-css-class="recNo">Items</th>
                                            <th data-column-id="Descr" data-header-css-class="Descr">Description</th>
                                            <th data-column-id="Qty" data-header-css-class="Qty" data-type="number" data-sortable="false">Qty</th>
                                            <th data-column-id="action" data-formatter="action" data-sortable="false" data-header-css-class="header-action">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in Model.ItemsPRList)
                                        {
                                            <tr>
                                                <td>@Html.DisplayFor(a=> item.PRLine.RequisitionLineId)</td>
                                                <td>@Html.DisplayFor(a => item.PRLine.SeqLineNo)</td>
                                                <td>@Html.DisplayFor(a => item.Item.Description)</td>
                                                <td>@Html.DisplayFor(a => item.PRLine.Description)</td>
                                                <td>@Html.DisplayFor(a => item.PRLine.Quantity)</td>
                                                <td></td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Menampilkan Form Add Line-->
<section class="content" id="Add-PR-Line">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>Add New Item</h2>
            </div>
            <div class="card-body card-padding">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <form id="form-add-new-line" role="form">

                                    <div class="col-md-6">

                                        <!--PR Number-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment-o zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>PR Number <span class="text-danger">*</span></label>
                                                <input asp-for="PRLineDetail.DocumentNo" class="form-control" id="LineDocNoAdd" value="@ViewBag.PRNumber" readonly />
                                            </div>
                                        </div><br /><br />

                                        <!--Recod Type-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-card-membership zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Type <span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.RecordType" asp-items="@ViewBag.RecordType" id="RecordTypeAdd" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Items-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-collection-item"></i></span>
                                            <div class="fg-line">
                                                <label>Items <span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.RecordNo" id="RecordNoAdd" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Description-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Description<span class="text-danger">*</span></label>
                                                <input asp-for="PRLineDetail.Description" id="DescriptionAdd" class="form-control" required />
                                            </div>
                                        </div><br /><br />

                                        <!-- Description 2-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <input asp-for="PRLineDetail.Description2" id="Description2Add" class="form-control" />
                                                <label class="fg-label">Description 2</label>
                                            </div>
                                        </div><br /><br />

                                    </div>

                                    <div class="col-md-6">

                                        <!--Qty-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-collection-plus zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <input asp-for="PRLineDetail.Quantity" type="number" id="QtyAdd" class="form-control" required />
                                                <label class="fg-label">Quantity<span class="text-danger">*</span></label>
                                            </div>
                                        </div><br /><br />

                                        <!--UoM-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-ruler zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Unit of Measure<span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.UnitofMeasure" id="UoMAdd" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Last Direct cost-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-money-box zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Expected Unit Price <span class="text-danger">*</span> (IDR)</label>
                                                <input asp-for="PRLineDetail.DirectUnitCost" type="number" id="ExpUnitCostAdd" class="form-control" required />
                                            </div>
                                        </div><br /><br />

                                        <!--Image-->
                                        <div class="form-group lightbox-item p-item">
                                            <div id="images-preview">
                                                <p class="f-500 c-black m-b-20">Image Preview</p>
                                                <div class="fileinput fileinput-new" data-provides="fileinput">
                                                    <div class="fileinput-preview thumbnail" data-trigger="fileinput"></div>
                                                    <div>
                                                        <span class="btn btn-info btn-file">
                                                            <span class="fileinput-new">Select image</span>
                                                            <span class="fileinput-exists">Change</span>
                                                            <input type="file" asp-for="PRLineDetail.Picture" name="gambarItem">
                                                        </span>
                                                        <a href="#" class="btn btn-danger fileinput-exists" data-dismiss="fileinput">Remove</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><br /><br />

                                            <!--Hidden Item-->
                                            <input asp-for="PRLineDetail.VatbusPostingGroup" type="text" id="VatBusAdd" hidden />
                                            <input asp-for="PRLineDetail.VatprodPostingGroup" type="text" id="VatProdAdd" hidden />
                                            <input asp-for="PRLineDetail.InventoryPostingGroup" type="text" id="InvenPostAdd" hidden />
                                            <input asp-for="PRLineDetail.ItemCategoryCode" type="text" id="ItemCatAdd" hidden />
                                            <input asp-for="PRLineDetail.ProductGroupCode" type="text" id="ProdGroupAdd" hidden />
                                            <input asp-for="PRLineDetail.GenProdPostingGroup" type="text" id="GenProdPostAdd" hidden />
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!--Add a button-->
                    <div class="col-md-2 col-md-offset-4">
                        <br />
                        <button type="button" class="btn btn-block palette-Blue bg waves-effect" id="btnAddLine" style="display:block" onclick="ValidateAddLine()"><span class="zmdi zmdi-edit zmdi-hc-fw"></span> Add</button>
                    </div><br />
                    <div class="col-md-2">
                        <button type="button" class="btn btn-block palette-Orange bg waves-effect" id="btnCancelAddLine"><span class="zmdi zmdi-rotate-left zmdi-hc-fw"></span> Back</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Menampilkan Form Edit Line per Items-->
<section class="content" id="Form-Show-Edit-Line">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>Edit Items</h2>
            </div>
            <div class="card-body card-padding">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <form id="Form-Edit-Line" role="form">

                                    <div class="col-md-6">

                                        <!--Line ID-->
                                        <input asp-for="PRLineDetail.RequisitionLineId" type="text" id="RequisitionLineIDEdit" hidden />

                                        <!--PR Number-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment-o zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>PR Number <span class="text-danger">*</span></label>
                                                <input asp-for="PRLineDetail.DocumentNo" class="form-control" id="LineDocNoAdd" value="@ViewBag.PRNumber" readonly />
                                            </div>
                                        </div><br /><br />

                                        <!--Recod Type-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-card-membership zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Type <span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.RecordType" asp-items="@ViewBag.RecordType" id="RecordTypeEdit" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Items-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-collection-item"></i></span>
                                            <div class="fg-line">
                                                <label>Items <span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.RecordNo" id="RecordNoEdit" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Description-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Description<span class="text-danger">*</span></label>
                                                <input asp-for="PRLineDetail.Description" id="DescriptionEdit" class="form-control" required />
                                            </div>
                                        </div><br /><br />

                                        <!-- Description 2-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-assignment zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <input asp-for="PRLineDetail.Description2" id="Description2Edit" class="form-control" />
                                                <label class="fg-label">Description 2</label>
                                            </div>
                                        </div><br /><br />

                                    </div>

                                    <div class="col-md-6">

                                        <!--Qty-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-collection-plus zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <input asp-for="PRLineDetail.Quantity" type="number" id="QtyEdit" class="form-control" required />
                                                <label class="fg-label">Quantity<span class="text-danger">*</span></label>
                                            </div>
                                        </div><br /><br />

                                        <!--UoM-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-ruler zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Unit of Measure<span class="text-danger">*</span></label>
                                                <select asp-for="PRLineDetail.UnitofMeasure" id="UoMEdit" class="selectpicker" data-width="100%" data-live-search="true">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div><br /><br />

                                        <!--Last Direct cost-->
                                        <div class="input-group fg-float">
                                            <span class="input-group-addon"><i class="zmdi zmdi-money-box zmdi-hc-fw"></i></span>
                                            <div class="fg-line">
                                                <label>Expected Unit Price <span class="text-danger">*</span> (IDR)</label>
                                                <input asp-for="PRLineDetail.DirectUnitCost" type="number" id="ExpUnitCostEdit" class="form-control" required />
                                            </div>
                                        </div><br /><br />

                                        <!--Images-->
                                        <div class="form-group lightbox-item p-item">
                                            <center>
                                                <a id="PR-Picture-Link" data-fancybox data-caption="PR Images">
                                                    <img id="PR-Picture" alt="PR Picture" style="width:250px; height:250px; max-width:100%; max-height:100%; border-radius:50%" />
                                                </a>
                                            </center>
                                            <br />
                                            <br />
                                            <center><button type="button" class="btn palette-Blue bg waves-effect center" id="btn-EditPRImages"> Change Image</button></center>

                                            <div id="images-previewEdit">
                                                <p class="f-500 c-black m-b-20">Image Preview</p>
                                                <div class="fileinput fileinput-new" data-provides="fileinput1">
                                                    <div class="fileinput-preview thumbnail" data-trigger="fileinput"></div>
                                                    <div>
                                                        <span class="btn btn-info btn-file">
                                                            <span class="fileinput-new">Select image</span>
                                                            <span class="fileinput-exists">Change</span>
                                                            <input type="file" asp-for="PRLineDetail.Picture" name="GambarItemEdit">
                                                        </span>
                                                        <a href="#" class="btn btn-danger fileinput-exists" data-dismiss="fileinput1">Remove</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <br />
                                        </div>

                                    </div>
                                    <!--Hidden Item-->
                                    <input asp-for="PRLineDetail.VatbusPostingGroup" type="text" id="VatBusEdit" hidden />
                                    <input asp-for="PRLineDetail.VatprodPostingGroup" type="text" id="VatProdEdit" hidden />
                                    <input asp-for="PRLineDetail.InventoryPostingGroup" type="text" id="InvenPostEdit" hidden />
                                    <input asp-for="PRLineDetail.ItemCategoryCode" type="text" id="ItemCatEdit" hidden />
                                    <input asp-for="PRLineDetail.ProductGroupCode" type="text" id="ProdGroupEdit" hidden />
                                    <input asp-for="PRLineDetail.GenProdPostingGroup" type="text" id="GenProdPostEdit" hidden />

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>








<!--sesi CSS dan JS Import-->
@section Styles{
    <!--Style CSS Import-->
    <link rel="stylesheet" href="~/ThemeForest/vendors/bower-components/bootstrap-select/dist/css/bootstrap-select.css" />
    <link rel="stylesheet" href="~/ThemeForest/vendors/bootgrid/jquery.bootgrid.min.css" />
    <!--End Style CSS Import-->
    <!--Custom CSS-->
    <style>
        .No {
            width: 15%;
        }

        .recNo {
            width: 20%;
        }

        .Descr {
            width: 40%;
        }

        .Qty {
            width: 10%;
        }

        .header-action {
            width: 15%;
        }
    </style>
    <!--End Custom CSS-->
}

@section Scripts{
    <!--Import JS-->
    <script type="text/javascript" src="~/ThemeForest/vendors/bootgrid/jquery.bootgrid.updated.min.js"></script>
    <script type="text/javascript" src="~/ThemeForest/sweetalert2/sweetalert2.all.min.js"></script>
    <script type="text/javascript" src="~/ThemeForest/vendors/bower-components/bootstrap-select/dist/js/bootstrap-select.js"></script>
    <script type="text/javascript" src="~/ThemeForest/vendors/fileinput/fileinput.min.js"></script>
    <!--End Import JS-->
    <!-- Custom JS-->
    <!--Document Ready Function()-->
    <script>
        $(document).ready(function () {
            $("#Header-Fixed").show();
            $("#Header-Editable").hide();
            $("#ListLine").show();
            $("#Add-PR-Line").hide();
            $("#Form-Show-Edit-Line").hide();

            //populate recordNo using recordType
            $("#RecordTypeAdd").on("change", function () {
                $("#DescriptionAdd").val('');
                $("#ExpUnitCostAdd").val('');
                $("#RecordNoAdd").empty();
                $("#RecordNoAdd").selectpicker('refresh');
                $("#UoMAdd").empty();
                $("#UoMAdd").selectpicker('refresh');
                var link = "/PurchaseRequest/PopulateRecordNo?RecordType=" + $("#RecordTypeAdd").val();
                $.ajax({
                    type: "GET",
                    contentType: "application/json",
                    url: link,
                    success: function (data) {
                        if (data.status == false) {
                            Swal.fire({
                                type: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong!',
                                footer: '' + result.message
                            })
                            $("#RecordNoAdd").selectpicker('refresh');
                        }
                        else {
                            var obj = JSON.parse(data.data);

                            $("#RecordNoAdd").append('<option></option>')
                            for (var i = 0; i < obj.length; i++) {
                                $("#RecordNoAdd").append('<option value="' + obj[i].No + '">"' + obj[i].Description + '"</option>');
                            }
                            $("#RecordNoAdd").selectpicker('refresh');
                        }
                    }
                })


            });

            $("#RecordNoAdd").on("change", function () {
                var link = "/PurchaseRequest/PopulateUoM";
                var selected = $(this).find("option:selected").text();
                $("#DescriptionAdd").val(selected);
                $("#UoMAdd").empty();
                $("#UoMAdd").selectpicker('refresh');
                $.ajax({
                    type: "GET",
                    contentType: "application/json",
                    url: link,
                    data: {
                        recNo: $("#RecordNoAdd").val(),
                        recType: $("#RecordTypeAdd").val()
                    },
                    success: function (result) {
                        var datalist = JSON.parse(result.data1);
                        var datadetail = JSON.parse(result.data2);
                        //isi select list
                        //$("#UoMAdd").append('<option></option>');
                        for (var i = 0; i < datalist.length; i++) {
                            $("#UoMAdd").append('<option value="' + datalist[i].code + '">"' + datalist[i].name + '"</option>')
                        }
                        $("#UoMAdd").val(datadetail.UoM);
                        $("#ExpUnitCostAdd").val(datadetail.cost);
                        $("#VatBusAdd").val(datadetail.VatBus);
                        $("#VatProdAdd").val(datadetail.VatProd);
                        $("#InvenPostAdd").val(datadetail.invenPost);
                        $("#ItemCatAdd").val(datadetail.itemCat);
                        $("#ProdGroupAdd").val(datadetail.prodGroup);
                        $("#GenProdPostAdd").val(datadetail.GenProdPost);
                        $("#UoMAdd").selectpicker('refresh');
                    }
                })

            });



            //Bootgrid untuk Table
            $("#tabel-daftar-item").bootgrid({
                caseSensitive: false,
                css: {
                    icon: 'zmdi icon',
                    iconColumns: 'zmdi-view-module',
                    iconDown: 'zmdi-expand-more',
                    iconRefresh: 'zmdi-refresh',
                    iconUp: 'zmdi-expand-less'
                },
                formatters: {
                    "action": function (column, row) {
                        return "<button type=\"button\" class=\"btn btn-icon command-delete waves-effect waves-circle\" onclick='EditPRLineItem(\"" + row.ID + "\")'><span class=\"zmdi zmdi-edit\"></span></button>" +
                            "<button type=\"button\" class=\"btn btn-icon command-delete waves-effect waves-circle\" onclick='DeletePRLineItem(\"" + row.ID + "\")'><span class=\"zmdi zmdi-delete\"></span></button>";
                    }
                }
            })
        })
    </script>
    <!--buttun View Edit Click()-->
    <script>
        $("#btnViewEditHeader").click(function () {
            $("#Header-Fixed").hide();
            $("#Header-Editable").show();
            $("#ListLine").hide();
            $("#Add-PR-Line").hide();
            $("#Form-Show-Edit-Line").hide();
        })
    </script>
    <!--Button btnCancelHeader Click()-->
    <script>
        $("#btnCancelHeader").click(function () {
            $("#Header-Fixed").show();
            $("#Header-Editable").hide();
            $("#ListLine").show();
            $("#Add-PR-Line").hide();
            $("#Form-Show-Edit-Line").hide();
        })
    </script>
    <!--Button Add Line Item Click-->
    <script>
        $("#AddLineItems").click(function () {
            $("#Header-Fixed").hide();
            $("#Header-Editable").hide();
            $("#ListLine").hide();
            $("#Add-PR-Line").show();
            $("#Form-Show-Edit-Line").hide();
        })
    </script>
    <!--Button Cancel Add line Click-->
    <script>
        $("#btnCancelAddLine").click(function () {
            $("#Header-Fixed").show();
            $("#Header-Editable").hide();
            $("#ListLine").show();
            $("#Add-PR-Line").hide();
            $("#Form-Show-Edit-Line").hide();
        })
    </script>

<!--Function EditLine Click-->
<script>
    async function EditPRLineItem(ID) {

        //call Function untuk mengisi field
        await isiField(ID);
        $("#images-previewEdit").hide();
        $("#Form-Show-Edit-Line").show();
        $("#Header-Fixed").hide();
        $("#Header-Editable").hide();
        $("#ListLine").hide();
        $("#Add-PR-Line").hide();
        
    }
    async function isiField(ID) {
        var link = "/PurchaseRequest/FindPRIDOpen?Id=" + ID;
        $.ajax({
            type: "GET",
            url: link,
            success: function (result) {
                var res = JSON.parse(result);
                $("#RecordTypeEdit").val(res.RecordType);
                $("#RecordTypeEdit").selectpicker('refresh');
                isiRecordNo(res.RecordType, res.RecordNo);
                
            }
        })
    }
    function isiRecordNo(recordType, RecordNo) {
        var link = "/PurchaseRequest/PopulateRecordNo?RecordType=" + recordType;
        $.ajax({
            type: "GET",
            url: link,
            success: function (result) {
                var res = JSON.parse(result.data);
                
                for (var i = 0; i < res.length; i++) {
                    $("#RecordNoEdit").append('<option value="' + res[i].No + '">"' + res[i].Description + '"</option>');
                }
                $("#RecordNoEdit").val(RecordNo);
                $("#RecordNoEdit").selectpicker('refresh');               
            }
        })
    }
</script>
    <!--Validate Header()-->
    <script>
        var noPR = $("#PRNumber").val();
        function ValidateHeader() {
            if (!$("#Requester").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Please Reload The Page..!'
                })
            } else if (!$("#DepartmentCode").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Your Department cannot be null..!'
                })
            } else if (!$("#receiptDate").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Receipt Date cannot be null..!'
                })
            } else if (!$("#ReqMotive").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Request Notes cannot be null..!'
                })
            } else if (!$("#locationCode").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Location cannot be null..!'
                })
            } else if (!$("#Priority").val()) {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Priority cannot be null..!'
                })
            } else {
                Swal.fire({
                    type: 'info',
                    title: 'Are You Sure?',
                    text: 'Edit This PR',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: '<i class="zmdi zmdi-edit"></i> Edit'

                }).then((result) => {
                    if (result.value) {
                        $.ajax({
                            type: 'POST',
                            url: '/PurchaseRequest/EditPRHeader',
                            data: $("#form-edit-header").serialize(),
                            success: function (result) {
                                if (result.status == true) {
                                    Swal.fire(
                                        'Saved!',
                                        'Your data has been saved.',
                                        'success'
                                    ).then((result) => {
                                        window.location.href = "/PurchaseRequest/AddPRNewDetailCSCSHTMLaqilhuiz?ReQUest=" + noPR;
                                    })
                                } else {
                                    Swal.fire({
                                        type: 'error',
                                        title: 'Oops...',
                                        text: 'Something went wrong!',
                                        footer: '' + result.message
                                    })
                                }
                            }

                        })
                    }
                })
            }
        }
    </script>

<!--Validate Add Line-->
<script>
    function ValidateAddLine() {
        var noPR = $("#PRNumber").val();
        if (!$("#LineDocNoAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank PR Number',
                text: 'Could not get the number of PR, Please refresh the page!'
            })
        }
        else if (!$("#RecordTypeAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank Type',
                text: 'Please Insert Type'
            })
        }
        else if (!$("#RecordNoAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank Item Name',
                text: 'Please Insert Item'
            })
        }
        else if (!$("#DescriptionAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank Item Description',
                text: 'Please Add Some Description'
            })
        }
        else if (!$("#QtyAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank Quantity',
                text: 'Please Insert Some Quantity'
            })
        }
        else if (!$("#ExpUnitCostAdd").val()) {
            Swal.fire({
                type: 'error',
                title: 'Blank Unit Price',
                text: 'Please Insert Expected Unit Price'
            })
        }
        else {
            Swal.fire({
                type: 'info',
                title: 'Are You Sure?',
                text: 'Add This Item into this PR?',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '<i class="zmdi zmdi-plus"></i> Add'
            }).then((result) => {
                if (result.value) {
                    var formData = new FormData($("#form-add-new-line")[0])
                    $.ajax({
                        type: 'POST',
                        url: '/PurchaseRequest/AddLineItems',
                        data: formData,
                        processData: false,
                        contentType: false,
                        success: function (result) {
                            if (result.status == true) {
                                Swal.fire(
                                    'Saved!',
                                    'Your data has been saved.',
                                    'success'
                                ).then((result) => {
                                    window.location.href = "/PurchaseRequest/AddPRNewDetailCSCSHTMLaqilhuiz?ReQUest=" + noPR;
                                })
                            }
                            else {
                                Swal.fire({
                                    type: 'error',
                                    title: 'Oops...',
                                    text: 'Something went wrong!',
                                    footer: '' + result.message
                                })
                            }
                        }
                    })
                }
            })
        }
    }
</script>



    <!-- End Custom JS-->
}